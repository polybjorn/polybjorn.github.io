---
const { lang = 'en', title, description, image } = Astro.props;
const otherLang = lang === 'en' ? 'no' : 'en';
const otherUrl = lang === 'en' ? '/no' : '/';
const path = Astro.url.pathname;
const canonicalUrl = `https://polybjorn.com${path === '/' ? '' : path}`;
const ogImage = image ?? 'https://res.cloudinary.com/det9ftymo/image/upload/c_pad,b_gen_fill,w_360,h_360/v1725405810/photo_jn86fv.jpg';
---
<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Piazzolla:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalUrl} />
    <link rel="alternate" hreflang="en" href="https://polybjorn.com" />
    <link rel="alternate" hreflang="no" href="https://polybjorn.com/no" />
    <link rel="alternate" hreflang="x-default" href="https://polybjorn.com" />
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage} />
    <!-- Twitter/X Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />
    <!-- JSON-LD -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "BjÃ¸rn A. Andersen",
      "url": "https://polybjorn.com",
      "image": "https://res.cloudinary.com/det9ftymo/image/upload/c_pad,b_gen_fill,w_360,h_360/v1725405810/photo_jn86fv.jpg",
      "sameAs": [
        "https://grabcad.com/bjorn.a.andersen-1",
        "https://social.polybjorn.com/@bjanda"
      ],
      "jobTitle": "3D Designer & Instructor",
      "description": "3D modelling, additive manufacturing, graphic design, and hands-on 3D printing courses.",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Haugesund",
        "addressCountry": "NO"
      },
      "knowsAbout": ["3D modelling", "3D printing", "Additive manufacturing", "Graphic design"],
      "offers": {
        "@type": "Service",
        "name": "3D Printing Courses",
        "description": "Hands-on courses in 3D printing and design.",
        "areaServed": "NO"
      }
    })} />
    <slot name="head" />
    <style>
      .lang-toggle {
        position: fixed;
        top: 1rem;
        right: 1rem;
        color: #555;
        text-decoration: none;
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        transition: color 0.2s;
        z-index: 100;
        font-family: 'Piazzolla', serif;
      }
      .lang-toggle:hover { color: #fff; }
    </style>
  </head>
  <body>
    <a class="lang-toggle" href={otherUrl}>{otherLang.toUpperCase()}</a>
    <slot />
    <script define:vars={{ lang }}>
      if (lang === 'en' && !localStorage.getItem('lang')) {
        if (navigator.language.startsWith('no')) {
          localStorage.setItem('lang', 'no');
          window.location.replace('/no');
        }
      }
      document.querySelector('.lang-toggle').addEventListener('click', () => {
        localStorage.setItem('lang', {lang} === 'en' ? 'no' : 'en');
      });
    </script>
  </body>
</html>